---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Hero from '../components/Hero.astro';
import Craftsmanship from '../components/Craftsmanship.astro';
import FeaturedProducts from '../components/FeaturedProducts.astro';
import ContactPreview from '../components/ContactPreview.astro';
import { getTranslation, getCurrentLang } from '../i18n/utils.js';

const lang = getCurrentLang(Astro.url);
const t = getTranslation(lang);

const title = `${t.hero.title} - Le Coin d'Or`;
const description = "مجوهرات فاخرة في غرداية منذ عام 1987. تصاميم فريدة من نوعها من الذهب عيار 18، حرفية تقليدية وخدمة شخصية. اكتشف مجموعاتنا الحصرية.";
---

<Layout title={title} description={description} lang={lang}>
  <Header />
  <main>
    <Hero />
    <Craftsmanship />
       <iframe
      id="ringSizerIframe"
      src="https://ringsizer-bijouterie.netlify.app"
      class="w-full border-none overflow-hidden transition-all duration-300 ease-in-out"
      scrolling="no"
    ></iframe>
     <!-- 🔽 Script pour ajuster dynamiquement la hauteur de l’iframe -->
    <script>
      window.addEventListener('message', (event) => {
        const iframe = document.getElementById('ringSizerIframe');

        // Optionnel : vérifier l’origine pour plus de sécurité
        // if (event.origin !== 'https://ringsizer-bijouterie.netlify.app') return;

        if (iframe && event.data?.height) {
          iframe.style.height = event.data.height + 'px';
        }
      });
    </script>
    <FeaturedProducts />
    <ContactPreview />
  </main>
  <Footer />
</Layout>